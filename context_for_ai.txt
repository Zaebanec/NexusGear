=============== NEXUS GEAR STORE (НАШ ПРОЕКТ) ===============


### File: ~/nexus-gear-store/docker-compose.yml


### File: ~/nexus-gear-store/src/presentation/bot.py


### File: /etc/nginx/sites-available/shop-nexus-gear.ru
# /etc/nginx/sites-available/shop-nexus-gear.ru - ФИНАЛЬНАЯ УПРОЩЕННАЯ ВЕРСИЯ

server {
    server_name shop-nexus-gear.ru;

    # --- НАЧАЛО ИЗМЕНЕНИЯ: ЕДИНЫЙ location ДЛЯ ВСЕХ ЗАПРОСОВ ---
    location / {
        # Все запросы (на /, /order, /webhook, /static/...) 
        # будут проксироваться на наше приложение.
        proxy_pass http://195.133.63.212:8081;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # Эти заголовки важны для WebSocket и других протоколов,
        # которые могут понадобиться в будущем.
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
    # --- КОНЕЦ ИЗМЕНЕНИЯ ---

    listen 443 ssl http2;
    # ... (все SSL-настройки остаются БЕЗ ИЗМЕНЕНИЙ) ...
}

# Блок для редиректа с HTTP на HTTPS остается БЕЗ ИЗМЕНЕНИЙ
server {
    if ($host = shop-nexus-gear.ru) {
        return 301 https://$host$request_uri;
    }
    listen 80;
    server_name shop-nexus-gear.ru;
    return 404; # managed by Certbot
}



=============== KALIN RENT BOT (СТАРЫЙ ПРОЕКТ) ===============


### File: ~/kalin-rent-bot/docker-compose.yml


### File: ~/kalin-rent-bot/src/main.py (ПРЕДПОЛОЖЕНИЕ)
File not found: ~/kalin-rent-bot/src/main.py


### File: /etc/nginx/sites-available/24kalinrentbot.ru
# Файл: /etc/nginx/sites-available/24kalinrentbot.ru
# ВЕРСИЯ: Финальная, с исправленным proxy_pass.

server {
    server_name 24kalinrentbot.ru;

    location / {
        # --- КЛЮЧЕВОЕ ИСПРАВЛЕНИЕ ---
        # Убеждаемся, что мы проксируем на HTTP, а не HTTPS.
        proxy_pass http://127.0.0.1:8080;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }

    listen [::]:443 ssl http2; # managed by Certbot
    listen 443 ssl http2; # managed by Certbot
    ssl_certificate /etc/letsencrypt/live/24kalinrentbot.ru/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/24kalinrentbot.ru/privkey.pem; # managed by Certbot
    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
}

server {
    if ($host = 24kalinrentbot.ru) {
        return 301 https://$host$request_uri;
    } # managed by Certbot

    listen 80;
    listen [::]:80;
    server_name 24kalinrentbot.ru;
    return 404; # managed by Certbot
}
